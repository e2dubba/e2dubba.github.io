<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bibliography</title>
    <script>
        const Urll = 'https://api.zotero.org/groups/2356093/items?itemType=-attachment+%7C%7C+note';
        
        function totalResultsAndPager(totalResults, links) {
            let nav = document.createElement('div');
            let forward = document.createElement('span');
            forward.style.cssText = 'float;right';
            forward.innerHTML = 'Next';
            let total = document.createElement('span');
            total.style.cssText = 'float;center';
            total.innerHTML = 'Number of Items: ' + totalResults;
        };

        function bibParser(data) {
            let table = document.createElement('table');
            table.id = 'bibTable';
            let thead = document.createElement('thead');
            for (const col of ['Contributor', 'Title', 'Date']) {
                let th = document.createElement('th');
                th.innerHTML(col);
                thead.appendChild(th)
            };

            for (const bib of data) {
                bib = bib.data;
                let tr = table.insertRow(-1);
                let authCell = tr.insertCell(-1);
                authCell.innerHTML = data.creators[0].join();
                for (const item of ['title', 'date']) {
                    let cell = tr.insertCell(-1);
                    tr.innerHTML = data[item];
                }
                
            };

            let div = document.getElementById('TableDiv');
            div.appendChild(table)

        };
            

        function grabBibliography() {
            fetch(Url)
              .then(resp=>{
                  let totalResults = resp.headers.get('Total-Result');
                  let links = resp.headers.get('Link');
                  totalResultsAndPager(totalResults, links);
                  return resp.json()})
              .then(data=>{bibParser(data)})

        };

    </script>
</head>
<body>
    <div id="TableDiv"></div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            grabBibliography();
        });
    </script>
    
</body>
</html>
